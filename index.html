<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32 BLE Control</title>
</head>
<body>
    <button id="connectButton">Connect to ESP32</button>
    <button id="toggleButton">Toggle LED</button>

    <script>
        let bleDevice;
        let bleServer;
        let bleCharacteristic;

        document.getElementById("connectButton").addEventListener("click", async () => {
            try {
                bleDevice = await navigator.bluetooth.requestDevice({
                    filters: [{ services: [0x6E400001] }] // Replace with your service UUID
                });

                bleServer = await bleDevice.gatt.connect();
                const service = await bleServer.getPrimaryService(0x6E400001); // Replace with your service UUID
                bleCharacteristic = await service.getCharacteristic(0x6E400003); // Replace with your characteristic UUID

                console.log("Connected to ESP32");
            } catch (error) {
                console.error("Error connecting:", error);
            }
        });

        document.getElementById("toggleButton").addEventListener("click", async () => {
            if (!bleCharacteristic) {
                console.error("Not connected to ESP32");
                return;
            }

            try {
                const message = "read_LED";
                await bleCharacteristic.writeValue(new TextEncoder().encode(message));

                console.log("Message sent:", message);
            } catch (error) {
                console.error("Error sending message:", error);
            }
        });
    </script>
</body>
</html>
